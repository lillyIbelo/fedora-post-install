---

#
# Local DNS server
#

- name: Enable local DNS server (networkmanager dnsmasq)
  ini_file: dest=/etc/NetworkManager/NetworkManager.conf
            section=main
            option=dns
            value=dnsmasq
            state=present
  register: local_dns
  notify:
   - restart networkmanager

- name: Etckeeper commit
  command: etckeeper commit "local DNS server - dnsmasq"
  when: etckeeper_enabled == true and local_dns.changed

#
# Additional packages
#

- name: Install additional packages
  dnf: name={{ item }} state=present
  with_items:
   - vim
   - gvim
   - tmux
   - vifm
   - mc
   - htop
   - lshw
   - acpi
   - wget
   - curl
   - wipe
   - ipython
   - python3-ipython
   - pylint
   - python3-pylint
   - python-ctags
   - xmlstarlet
   - jq
   - git
   - git-annex
   - tig
   - gitk
   - meld
   - terminator
   - tmuxinator
   - pandoc
   - groovy
   - xmonad
   - xmobar
   - pmount
   - xloadimage
   - firefox
   - thunderbird
   - thunderbird-enigmail
   - keepassx
   - rxvt-unicode
   - ruby
   - ruby-irb
   - mutt
   - notmuch-mutt
   - abook
   - goobook
   - msmtp
   - offlineimap
   - graphviz
   - epydoc
   - mercurial
   - darcs
   - fedpkg
   - audacity
   - unoconv
   - qstardict
   - libappindicator
   - libappindicator-gtk3
   - xscreensaver
   - pavucontrol
   - geeqie
   - nmap
   - tigervnc
   - ddrescue
   - fbreader

#
# Make dnf to ignore kernel package
#

- name: Configure dnf - ignore kernel package
  ini_file: dest=/etc/dnf/dnf.conf
            section=main
            option=exclude
            value=kernel*
            state=present
  register: dnf_config_exclude

- name: Etckeeper commit
  command: etckeeper commit "dnf - exclude kernel packages"
  when: etckeeper_enabled == true and dnf_config_exclude.changed
